function addEvent(a, b, c) {
    if (a.nodeName === "A" && b === "click") {
        a.setAttribute("href", "javascript:void(0)")
    };
    if (a.addEventListener) {
        a.addEventListener(b, c, false);
        return true
    } else if (a.attachEvent) {
        a['e' + b + c] = c;
        a[b + c] = function() {
            a['e' + b + c](window.event)
        };
        a.attachEvent("on" + b, a[b + c]);
        return true
    };
    return false
};
function slide(o) {
    var c = o.handle,
    content = o.content,
    mode = o.mode || "moseover",
    myClass = o.current,
    speed = o.speed,
    fn = o.fn,
    flag = 0,
    past = 0,
    timer;
    for (var i = 0; i < c.length; i++) { (function(i) {
            addEvent(c[i], mode, 
            function() {
                clearTimeout(timer);
                show(i)
            })
        })(i);
        if (c[i].className.indexOf(myClass) != -1) past = i
    };
    function show(a) {
        var i = a;
        var b = new RegExp(myClass, 'g');
        c[past].className = c[past].className.replace(b, "");
        content[past].style.display = "none";
        past = a;
        c[i].className += " " + myClass;
        content[i].style.display = "block";
        if (c[i].nodeName === "A") c[i].blur(); (a + 1) == c.length ? a = 0: a++;
        if (speed) {
            timer = setTimeout(function() {
                show(a)
            },
            speed);
            addEvent(content[i], "mouseover", 
            function() {
                clearTimeout(timer)
            });
            addEvent(content[i], "mouseout", 
            function() {
                clearTimeout(timer);
                timer = setTimeout(function() {
                    show(a)
                },
                speed)
            })
        };
        if (fn) fn()
    };
    if (speed) show(flag)
};